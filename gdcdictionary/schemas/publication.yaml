$schema: "http://json-schema.org/draft-04/schema#"

id: "publication"
title: Publication
type: object
namespace: http://gen3.niehs.nih.gov
category: administrative
program: '*'
project: '*'
description: "Publication is a process - the act of issuing printed materials synonym: printed materials includes peer-reviewed journal articles, DNTP reports, white papers, deposition of data in SRA, etc. metadata: date of publication, authors, contact information, supporting data location, link to data in other databases,  GEO: species taxon and platform ID"
additionalProperties: false
submittable: true
validators: null

systemProperties:
  - id
  - project_id
  - publication_id
  - authors
  - data_in_publication #TODO: verify this is not just repeated as samples in data
  - data_owner
  - email
  - phone
  - lab
  - academic_department
  - academic_institution
  - institution_address
  - institution_city
  - institution_state
  - institution_post_zip_code
  - institution_country
  - data_location
  - keywords
  - data_location_relationships
  - state
  - created_datetime
  - updated_datetime

links:
  - name: projects
    backref: publications
    label: refers_to
    target_type: project
    multiplicity: many_to_many
    required: true

required:
  - submitter_id
  - type
  - projects

uniqueKeys:
  - [ id ]
  - [ project_id, submitter_id ] 

properties:
  type:
    enum: [ "publication" ] 
  id:
    $ref: "_definitions.yaml#/UUID"
    systemAlias: node_id
  state:
    $ref: "_definitions.yaml#/state"
  submitter_id:
    type:
      - string
      - "null"
  pmid:
    type: string
  doi:
    type: string
  projects:
    $ref: "_definitions.yaml#/to_many_project"
  project_id:
    type: string
  publication_id:
    type: string
    description: "PUBMED ID for publication ID[publication:PUBMED ID]"
  authors:
    type: array
    minItems: 1
    items:
        author:
          type: string
          description: "author name [publication:author]"

data_owner:
  type: string
  description: "data owner name [publication:data owner]"

email:
  type: string
  description: "email [publication:email]"

phone:
  type: string
  description: "phone [publication:phone]"

lab:
  type: string
  description: "lab [publication:lab]"

academic_department:
  type: string
  description: "academic department [publication:academic department]"

academic_institution:
  type: string
  description: "academic institution [publication:academic institution]"

institution_address:
  type: string
  description: "institution address [publication:institution address]"

institution_city:
  type: string
  description: "institution city [publication:institution city]"

institution_state:
  type: string
  description: "institution state [publication:institution state]"

institution_post_zip_code:
  type: string
  description: "institution post zip code [publication:institution post / zip code]"

institution_country:
  type: string
  description: "institution country [publication:institution country]"

data_location:
  type: array
    minItems: 1
    items:
        ftp_link:
          type: string
          description: "link to data [publication:data location]"
data_location:
  type: array
    minItems: 1
    items:
        ftp_link:
          type: string
          description: "link to data [publication:data location]"


data_location_relationships:
  type: array
    minItems: 1
    items:
        data_location_relationship:
          type: string
          description: "data location relationship [publication:data location relationship]"

keywords:
  type: array
    minItems: 1
    items:
      keyword:
        type: object
        additionalProperties: True
        properties:
          key_name:
            type: string
            description: "keyword name [publication:keyword]"
          value:
            type: string
            description: "keyword value [publication:value]"

uniqueItems: true
  created_datetime:
    $ref: "_definitions.yaml#/datetime"
  updated_datetime:
    $ref: "_definitions.yaml#/datetime"
